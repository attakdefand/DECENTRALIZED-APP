# Identity and Access Management - RBAC Map

This document provides a comprehensive mapping of roles, permissions, and access controls within the DECENTRALIZED-APP project.

## Overview

The Role-Based Access Control (RBAC) map defines the permissions and access levels for different user roles in the system. This ensures that users have the minimum necessary permissions to perform their duties (principle of least privilege).

## Role Definitions

### 1. Administrator
- **Role ID**: admin
- **Description**: Full system access with all permissions
- **Permissions**:
  - user.manage
  - system.configure
  - code.read
  - code.write
  - code.delete
  - policy.manage
  - audit.view
  - report.generate

### 2. Developer
- **Role ID**: developer
- **Description**: Standard development permissions
- **Permissions**:
  - code.read
  - code.write
  - test.execute
  - build.trigger
  - repo.access

### 3. Security Officer
- **Role ID**: security-officer
- **Description**: Security monitoring and incident response
- **Permissions**:
  - audit.view
  - log.analyze
  - incident.manage
  - policy.review
  - report.generate
  - vulnerability.scan

### 4. Auditor
- **Role ID**: auditor
- **Description**: System auditing and compliance verification
- **Permissions**:
  - audit.view
  - log.read
  - report.view
  - policy.review
  - compliance.check

### 5. Operations
- **Role ID**: operations
- **Description**: Infrastructure and operations management
- **Permissions**:
  - system.monitor
  - system.configure
  - deployment.execute
  - log.view
  - metrics.read

## Separation of Duties (SoD) Matrix

### Critical Functions and Required Roles

| Function | Required Role(s) | SoD Violation Rules |
|---------|------------------|---------------------|
| User Management | admin | Cannot be performed by same person who approves access requests |
| System Configuration | admin, operations | Cannot be performed by same person who audits changes |
| Code Deployment | developer, operations | Cannot be performed by same person who reviews code |
| Policy Management | admin, security-officer | Cannot be performed by same person who audits policies |
| Audit Management | auditor | Cannot be performed by same person who makes system changes |

### SoD Violation Detection Rules

1. No single user can have both admin and auditor roles
2. No single user can have both developer and security-officer roles
3. No single user can have both operations and auditor roles

## Access Review Process

### Quarterly Access Reviews

#### Review Schedule
- **Q1 Review**: March 31st
- **Q2 Review**: June 30th
- **Q3 Review**: September 30th
- **Q4 Review**: December 31st

#### Review Process Steps
1. **Notification**: System sends review notifications to role owners
2. **Review**: Role owners validate current access assignments
3. **Certification**: Role owners certify or revoke access
4. **Reporting**: Generate access review completion reports
5. **Audit**: Security team audits review completion

#### Metrics Tracked
- access_review_completion_pct: Percentage of required access reviews completed
- sod_violations: Number of active SoD violations detected

## mTLS and OPA Policies

### mTLS Configuration
- All internal service communication requires mutual TLS authentication
- Client certificates are rotated quarterly
- Certificate revocation lists are updated in real-time

### OPA Policies
- Infrastructure access policies enforced via OPA
- Repository access policies enforced via OPA/Cedar
- Data access policies enforced via OPA/Cedar

### Policy Bundles
- Policy bundles are signed and versioned
- Bundle updates require security team approval
- Policy decisions are logged for audit purposes

## Access Review Reports

### Report Contents
- User access summary by role
- Access review completion status
- SoD violation report
- Stale access identification
- Access request history

### Report Generation
- Automated quarterly reports generated by system
- Ad-hoc reports available on demand
- Reports stored in secure audit log system

### Metrics Tracked
- access_review_completion_pct: 100
- sod_violations: 0

## Recertification Process

### Recertification Triggers
- Quarterly scheduled recertification
- Role change events
- Access request approvals
- Security incident responses

### Recertification Workflow
1. **Initiation**: System or manual trigger initiates recertification
2. **Notification**: Role owners notified of recertification requirement
3. **Review**: Role owners review and validate access
4. **Approval**: Security team approves recertification
5. **Logging**: All actions logged for audit trail

## Integration with Identity Providers

### Supported IdPs
- OAuth2/OpenID Connect providers
- SAML 2.0 identity providers
- LDAP/Active Directory

### Federation Configuration
- Role mapping from IdP groups to application roles
- Attribute-based access control mappings
- Session management configuration

## Audit and Compliance

### Audit Logging
- All access decisions logged with timestamp and user context
- Role assignment changes logged with approver information
- Policy evaluation decisions logged for traceability

### Compliance Reporting
- Quarterly access review completion reports
- SoD violation reports
- Access recertification status reports
- Least privilege adherence metrics

## Implementation Status

### Current Implementation
- ✅ RBAC policies defined
- ✅ Role assignments implemented
- ✅ SoD rules documented
- ✅ Access review process established
- ✅ mTLS configuration defined
- ✅ OPA policies implemented

### Pending Implementation
- ⏳ Automated access review notifications
- ⏳ Integration with external IdPs
- ⏳ Real-time SoD violation detection